<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Dashboard</title>

    <!-- Montserrat Font -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&display=swap"
      rel="stylesheet"
    />

    <!-- Material Icons -->
    <link
      href="https://fonts.googleapis.com/icon?family=Material+Icons+Outlined"
      rel="stylesheet"
    />

    <!-- External CSS -->
    <link rel="stylesheet" href="../DASHBOARD/dashboard.css" />
    <link rel="stylesheet" href="../GENERAL/style.css" />
  </head>
  <body>
    <div class="grid-container" id="containerId">
      <main class="main-container">
        <div class="main-title">
          <h2>DASHBOARD</h2>
        </div>
        <div class="main-cards">
          <a href="../MEMBERS/members.html">
            <div class="card one">
              <div class="card-inner">
                <h3>MEMBERS</h3>
                <span class="material-icons-outlined"> people </span>
              </div>
              <h1>249</h1>
            </div>
          </a>

          <a href="../CONTRIBUTION/contribution.html">
            <div class="card two">
              <div class="card-inner">
                <h3>CONTRIBUTION</h3>
                <span class="material-icons-outlined"> payments </span>
              </div>
              <h1>250000</h1>
            </div>
          </a>

          <a href="../COMMUNITY/community.html">
            <div class="card three">
              <div class="card-inner">
                <h3>COMMUNITIES</h3>
                <span class="material-icons-outlined"> groups </span>
              </div>
              <h1>34</h1>
            </div>
          </a>

          <div class="card">
            <div class="card-inner">
              <h3>ONGOING PROJECTS</h3>
              <span class="material-icons-outlined"> rowing </span>
            </div>
            <h1>2</h1>
          </div>
        </div>

        <div class="charts">
          <div class="charts-card">
            <h2 class="chart-title">Top 5 Products</h2>
            <div id="bar-chart"></div>
          </div>

          <div class="charts-card">
            <h2 class="chart-title">Purchase and Sales Orders</h2>
            <div id="area-chart"></div>
          </div>
        </div>
      </main>
    </div>


    <script>
      document.addEventListener("DOMContentLoaded", () => {
        const token = localStorage.getItem("authToken"); // adjust key if named differently

        if (!token) {
          console.error("No auth token found.");
          return;
        }

        // Fetch registered users count
        fetch("http://localhost:8080/user/count", {
          headers: {
            Authorization: `Bearer ${token}`,
          },
        })
          .then((res) => res.json())
          .then((userCount) => {
            document.querySelector(".card:nth-child(1) h1").textContent =
              userCount;
          })
          .catch((error) => {
            console.error("Failed to fetch user count:", error);
          });

        // Fetch total contribution amount
        fetch("http://localhost:8080/contributions/totalAmount", {
          headers: {
            Authorization: `Bearer ${token}`,
          },
        })
          .then((res) => res.json())
          .then((total) => {
            document.querySelector(".card:nth-child(2) h1").textContent =
              total.toLocaleString();
          })
          .catch((error) => {
            console.error("Failed to fetch total contributions:", error);
          });

        // Fetch group count with description=community
        fetch("http://localhost:8080/group/count?description=community", {
          headers: {
            Authorization: `Bearer ${token}`,
          },
        })
          .then((res) => res.json())
          .then((groupCount) => {
            document.querySelector(".card:nth-child(3) h1").textContent =
              groupCount;
          })
          .catch((error) => {
            console.error("Failed to fetch group count:", error);
          });
      });
    </script>

<script  src="https://cdnjs.cloudflare.com/ajax/libs/apexcharts/4.3.0/apexcharts.min.js"></script>
<script>var barChartOptions = {
  series: [
    {
      data: [10, 8, 6, 4, 2],
      name: "Products",
    },
  ],
  chart: {
    type: "bar",
    background: "transparent",
    height: 350,
    toolbar: {
      show: false,
    },
  },
  colors: ["#2962ff", "#d50000", "#2e7d32", "ff6d00", "#583cb3"],
  plotOptions: {
    bar: {
      distributed: true,
      borderRadius: 2,
      columnWidth: "40%",
      horizontal: false,
    },
  },
  dataLabels: {
    enabled: false,
  },
  fill: {
    opacity: 1,
  },
  grid: {
    borderColor: "#55596e",
    yaxis: {
      lines: {
        show: true,
      },
    },
  },
  legend: {
    labels: {
      colors: "#f5f7ff",
    },
    show: true,
    position: "top",
  },
  stroke: {
    colors: ["transparent"],
    show: true,
    width: 2,
  },
  tooltip: {
    shared: true,
    intersect: false,
    theme: "dark",
  },
  xaxis: {
    categories: ["Laptop", "Phone", "Monitor", "Headphones", "Camera"],
    title: {
      style: {
        color: "#f5f7ff",
      },
    },
    axisBorder: {
      show: true,
      color: "#55596e",
    },
    axisTicks: {
      show: true,
      color: "#55596e",
    },
    labels: {
      style: {
        colors: "#f5f7ff",
      },
    },
  },
  yaxis: {
    title: {
      text: "Count",
      style: {
        colors: "#f5f7ff",
      },
    },
    axisBorder: {
      color: "#55596e",
      show: true,
    },
    axisTicks: {
      color: "#55596e",
      show: true,
    },
    labels: {
      style: {
        colors: "#f5f7ff",
      },
    },
  },
};

var barChart = new ApexCharts(
  document.querySelector("#bar-chart"),
  barChartOptions
);
barChart.render();

// AREA CHART
var areaChartOptions = {
  series: [
    {
      name: "Purchase Orders",
      data: [31, 40, 28, 51, 42, 109, 100],
    },
    {
      name: "Sales Orders",
      data: [11, 32, 45, 32, 34, 52, 41],
    },
  ],
  chart: {
    type: "area",
    background: "transparent",
    height: 350,
    stacked: false,
    toolbar: {
      show: false,
    },
  },
  colors: ["#00ab57", "#d50000"],
  labels: ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul"],
  dataLabels: {
    enabled: false,
  },
  fill: {
    gradient: {
      opacityFrom: 0.4,
      opacityTo: 0.1,
      shadeInensity: 1,
      stops: [0, 100],
      type: "vertical",
    },
    type: "gradient",
  },
  grid: {
    borderColor: "#55596e",
    yaxis: {
      lines: {
        show: true,
      },
    },
    xaxis: {
      lines: {
        show: true,
      },
    },
  },
  legend: {
    labels: {
      colors: "#f5f7ff",
    },
    show: true,
    position: "top",
  },
  markers: {
    size: 6,
    strokeColors: "#1b2635",
    strokeWidth: 3,
  },
  stroke: {
    curve: "smooth",
  },
  xaxis: {
    axisBorder: {
      color: "#55596e",
      show: true,
    },
    axisTicks: {
      color: "#55596e",
      show: true,
    },
    labels: {
      offsetY: 5,
      style: {
        colors: "#f5f7ff",
      },
    },
  },
  yaxis: [
    {
      title: {
        text: "Purchase Orders",
        style: {
          color: "#f5f7ff",
        },
      },
      labels: {
        style: {
          color: "#f5f7ff",
        },
      },
    },
    {
      opposite: true,
      title: {
        text: "Ssles Orders",
        style: {
          color: "#f5f7ff",
        },
      },
      labels: {
        style: {
          color: "#f5f7ff",
        },
      },
    },
  ],
  tooltip: {
    shared: true,
    intersect: false,
    theme: "dark", 
  }
};
   

var areaChart = new ApexCharts(
  document.querySelector("#area-chart"),
  areaChartOptions
);
areaChart.render();
</script>
<script src="../GENERAL/script.js"></script>


  </body>
</html>
